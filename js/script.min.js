"use strict";const MODAL_ANIMATION_DURATION=400,TABLET_WIDTH_MEDIA_QUERY="(min-width: 768px)",FormEvents={SUBMIT_START:"formSubmitStart",SUBMIT_END:"formSubmitEnd"};function getPaginationButtonCreator(e="Слайд"){return(t,s)=>`\n    <button class='${s}' type='button'>\n      <span class='visually-hidden'>${e} ${t+1}.</span>\n    </button>\n  `}function createElementByString(e){const t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function initFormResending(e,t){function s(){e.removeListener(FormEvents.SUBMIT_START,s),e.addListener(FormEvents.SUBMIT_END,n),t.buttonElement.disabled=!0,t.buttonElement.classList.add("button--pending")}function n(){e.removeListener(FormEvents.SUBMIT_END,n),t.close()}t.buttonElement.addEventListener("click",(t=>{t.preventDefault(),e.addListener(FormEvents.SUBMIT_START,s),e.element.requestSubmit()}))}async function sendData(e,t,s=()=>{},n=()=>{},i=()=>{}){try{const n=await fetch(e,{method:"POST",body:t});if(!n.ok){const e=await n.text();throw new Error(`${n.status} – ${n.statusText}: ${e}`)}s(await n.json())}catch(e){console.error(e.message),n()}finally{i()}}class PubSub{constructor(){this.listeners={}}addListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}removeListener(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter((e=>e!==t)))}emit(e,t){this.listeners[e]&&this.listeners[e].forEach((e=>e(t)))}}class Modal{constructor(e){this.modalElement=e,this.name=e?.dataset.modal,this.initOpeners(),this.modalElement.addEventListener("close",(()=>this.onModalClose())),this.modalElement.addEventListener("click",(e=>{(e.target===this.modalElement||e.target.closest("[data-modal-close-button]"))&&(e.preventDefault(),this.close())}))}initOpeners=()=>{document.querySelectorAll(`[data-modal-opener="${this.name}"]`).forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),this.open()}))}))};open=()=>{requestAnimationFrame((()=>{this.modalElement.showModal()}))};close=()=>{this.modalElement.close()};onModalClose=()=>{this.modalElement.classList.contains("modal--with_alert")&&setTimeout((()=>{this.modalElement.remove(),this.modalElement=null}),400)}}class Alert extends Modal{constructor({heading:e,text:t,status:s="success"}){const n=Alert.createElement({heading:e,text:t,status:s});document.body.append(n),super(n),this.buttonElement=n.querySelector(".alert__button")}static createElement({heading:e,text:t,status:s}){return createElementByString(`\n      <dialog class="modal modal--with_alert">\n        <div class="modal__inner">\n          <button class="modal__close-button" type="button" data-modal-close-button>\n            <span class="visually-hidden">Закрыть</span>\n          </button>\n          <section class="alert modal__alert">\n            <h2 class="alert__heading heading">${e}</h2>\n            ${t?`<p class="alert__text">${t}</p>`:""}\n            <button class="alert__button button button--primary" type="button" ${"success"===s&&"data-modal-close-button"}>\n              <span class="button__text">${"error"===s?"Попробовать снова":"Закрыть"}</span>\n            </button>\n          </section>\n        </div>\n      </dialog>\n    `)}}class FilesField{allowedFormats=["image/png","image/jpg","image/jpeg",".pdf","application/pdf",".doc",".docx",".xml","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"];constructor(e){this.element=e,this.controlElement=this.element.querySelector(".files-field__control"),this.filesWrapperElement=this.element.querySelector(".files-field__files"),this.filesListElement=this.element.querySelector(".files-field__list"),this.files=new Set,this.init()}checkFileFormat=e=>this.allowedFormats.includes(e.type);updateFilesList=()=>{this.errorTextElement?.remove();const e=document.createDocumentFragment();this.files.forEach((t=>{const s=createElementByString(`\n        <li class="files-field__list-item">\n          <p class="files-field__file-name">${t.name}</p>\n          <button class="files-field__flle-delete-button" type="button">\n            <span class="visually-hidden">Открепить файл</span>\n          </button>\n        </li>\n      `);s.querySelector(".files-field__flle-delete-button").addEventListener("click",(e=>{e.preventDefault(),this.files.delete(t),this.updateFilesList()})),e.append(s)})),this.filesListElement.innerHTML="",this.filesListElement.append(e),this.files.size?this.filesWrapperElement.classList.remove("files-field__files--hidden"):this.filesWrapperElement.classList.add("files-field__files--hidden")};onControlChange=e=>{this.errorTextElement?.remove();const t=Array.from(e.target.files);t.length||this.files.size||this.filesWrapperElement.classList.add("files-field__files--hidden"),t.forEach((e=>{this.checkFileFormat(e)?(this.files.add(e),this.updateFilesList()):(this.errorTextElement=createElementByString('<p class="files-field__error-text">Не удалось прикрепить файл</p>'),this.filesWrapperElement.insertAdjacentElement("beforeend",this.errorTextElement),this.filesWrapperElement.classList.remove("files-field__files--hidden"))}))};reset=()=>{this.filesWrapperElement.classList.add("files-field__files--hidden"),this.errorTextElement?.remove(),this.filesListElement.innerHTML="",this.files.clear()};init=()=>{this.controlElement.addEventListener("change",this.onControlChange)}}class FormValidator{constructor(e){this.formElement=e,this.addCustomErrorMessages(),this.init()}addCustomErrorMessages(){const e=this.formElement.querySelector('[data-name="name"]'),t=this.formElement.querySelector('[data-name="phone"]');e&&(e.closest(".text-field").classList.add("pristine-item"),e.dataset.pristinePattern="/^[a-zа-яЁё -]+$/i",e.dataset.pristineRequiredMessage="Заполните это поле.",e.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),t&&(t.closest(".text-field").classList.add("pristine-item"),t.dataset.pristineRequiredMessage="Заполните это поле.")}validate(){return this.pristine.validate()}reset(){this.pristine.reset(),this.formElement.querySelectorAll(".shake").forEach((e=>e.classList.remove("shake")))}init(){this.pristine=new Pristine(this.formElement,{classTo:"pristine-item",errorClass:"pristine-item--invalid",errorTextParent:"pristine-item",errorTextTag:"p",errorTextClass:"pristine-item__error-text"})}}class Form extends PubSub{constructor(e){super(),this.element=e,this.actionUrl=this.element.action,this.submitButtonElement=this.element.querySelector("[data-submit-button]"),this.validator=new FormValidator(this.element),this.successHandler=null,this.errorHandler=null;const t=this.element.querySelector(".files-field");t&&(this.filesField=new FilesField(t)),this.init()}setHandlers=(e,t)=>{this.successHandler=e,this.errorHandler=t};init=()=>{this.element.addEventListener("submit",(e=>{e.preventDefault();if(this.validator.validate()){this.emit(FormEvents.SUBMIT_START),this.submitButtonElement.disabled=!0,this.submitButtonElement.classList.add("button--pending");const t=new FormData(e.target);this.filesField?.files.forEach((e=>{t.append("files[]",e)})),sendData(this.actionUrl,t,(e=>{this.successHandler(e),this.element.reset()}),(e=>{this.errorHandler(e)}),(()=>{this.emit(FormEvents.SUBMIT_END),this.submitButtonElement.disabled=!1,this.submitButtonElement.classList.remove("button--pending")}))}else{const e=this.element.querySelectorAll(".pristine-item--invalid");e.forEach((e=>{e.classList.remove("shake"),requestAnimationFrame((()=>e.classList.add("shake")))})),e[0]?.querySelector("input").focus()}})),this.element.addEventListener("reset",(()=>{this.validator.reset(),this.filesField?.reset()}))}}class ModalForm extends Modal{constructor(e){super(e),this.formElement=e.querySelector(".modal-form"),this.form=new Form(this.formElement)}setHandlers=(e,t)=>{this.form.setHandlers((()=>{e(),this.modalElement.close()}),(()=>{t()}))}}function initAnchors(){const e=document.querySelector(".page__inner");document.querySelectorAll(".pricing__anchor").forEach((t=>{t.addEventListener("click",(s=>{s.preventDefault();const n=document.querySelector(t.getAttribute("href")).getBoundingClientRect().top;e.scrollTo({top:e.scrollTop+n,behavior:"smooth"})}))}))}function initBanners(e){const t=e.querySelector(".banners__slider");new Swiper(t,{effect:"fade",fadeEffect:{crossFade:!0},loop:!0,autoplay:{delay:6e3,disableOnInteraction:!1},pagination:{el:".banners__slider-pagination",bulletClass:"banners__slider-pagination-button",bulletActiveClass:"banners__slider-pagination-button--current",renderBullet:getPaginationButtonCreator(),clickable:!0},on:{autoplayTimeLeft:(e,s,n)=>{t.style.setProperty("--slider-progress",1-n)}}})}function initDropdown(e){function t(t){(t.target.closest(".dropdown")!==e||t.target.matches(".dropdown__list-wrapper"))&&(t.preventDefault(),s())}function s(){e.classList.remove("dropdown--open"),document.removeEventListener("click",t)}e.addEventListener("click",(n=>{if(n.target.closest(".dropdown__toggle-button"))e.classList.contains("dropdown--open")?s():(e.classList.add("dropdown--open"),setTimeout((()=>{document.addEventListener("click",t)}),0));else{const t=n.target.closest(".dropdown__item");if(t){const n=t.querySelector(".dropdown__item-button");e.querySelector(".dropdown__toggle-button-text").textContent=n.textContent,s()}}}))}function initLicenses(){const e=document.querySelector(".licenses"),t=e.querySelector(".licenses__slider");new Swiper(t,{slidesPerView:"auto",spaceBetween:16,breakpoints:{1024:{slidesPerView:3,spaceBetween:30}}});const s=e.querySelector(".license-card__users-list");if(!s)return;const n=s.closest(".license-card"),i=s.querySelectorAll(".license-card__users-button"),r=n.querySelector(".license-card__price-wrapper [data-old-price]"),a=n.querySelector(".license-card__price-wrapper [data-price]");s?.addEventListener("click",(e=>{const t=e.target.closest(".license-card__users-button");if(!t)return;i.forEach((e=>e.classList.remove("license-card__users-button--active"))),t.classList.add("license-card__users-button--active");const{price:s,oldPrice:n}=t.dataset;((e,t)=>{e&&a&&(a.textContent=`${Number(e).toLocaleString()} ₽`),t&&r&&(r.textContent=`${Number(t).toLocaleString()} ₽`)})(s,n)}))}function initPageSlider(){const e=["about","capabilities","prices"],t=document.querySelector(".page-slider"),s=document.querySelectorAll(".logo, .site-navigation__link");let n=null;const i=new Swiper(t,{effect:"fade",fadeEffect:{crossFade:!0},autoHeight:!0,allowTouchMove:!1});s.forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault(),n?.classList.contains("site-navigation__link")&&n?.classList.remove("site-navigation__link--active");const s=t.currentTarget.getAttribute("href").slice(1),r=e.indexOf(s);i.slideTo(r),t.currentTarget.classList.contains("site-navigation__link")&&t.currentTarget.classList.add("site-navigation__link--active"),n=t.currentTarget}))}))}function initPhoneField(e){function t(e){return e.value.replace(/\D/g,"")}e.addEventListener("input",(function(e){const s=e.target;let n=t(s),i="";const r=s.selectionStart;if(!n)return void(s.value="");if(s.value.length!==r)return void(e.data&&/\D/g.test(e.data)&&(s.value=n));if(!["7","8","9"].includes(n[0]))return void(s.value=`+${n}`.substring(0,16));"9"===n[0]&&(n=`7${n}`),i=`${"8"===n[0]?"8":"+7"} `,n.length>1&&(i+=`(${n.substring(1,4)}`),n.length>=5&&(i+=`) ${n.substring(4,7)}`),n.length>=8&&(i+=`-${n.substring(7,9)}`),n.length>=10&&(i+=`-${n.substring(9,11)}`),s.value=i})),e.addEventListener("keydown",(function(e){const s=e.target;"Backspace"===e.code&&1===t(s).length&&(s.value="",s.dispatchEvent(inputEvent),s.dispatchEvent(changeEvent))})),e.addEventListener("paste",(function(e){const s=e.clipboardData||window.clipboardData,n=e.target,i=t(n);if(s){const e=s.getData("Text");/\D/g.test(e)&&(n.value=i)}}))}function showAlert({heading:e,text:t,status:s}){const n=new Alert({heading:e,text:t,status:s});return requestAnimationFrame((()=>n.open())),n}function initSkeleton(e){const t=e.querySelector("img"),s=e.querySelector("video"),n=t||s;if(n){if(t?t.complete:s.readyState>=1)e.classList.add("skeleton--loaded");else{const i=t?"load":"loadeddata";n.addEventListener(i,(()=>{e.classList.add("skeleton--loaded")}),{once:!0});const r=new MutationObserver((()=>{(t&&t.complete||s&&s.readyState>=1)&&(e.classList.add("skeleton--loaded"),r.disconnect())}));r.observe(n,{attributes:!0,attributeFilter:["src"]}),setTimeout((()=>{(t&&t.complete||s&&s.readyState>=1)&&e.classList.add("skeleton--loaded")}),1500)}}}function initSkeletons(e=document){e.querySelectorAll(".skeleton").forEach(initSkeleton)}function initSocials(e){const t=document.querySelector(".page__inner"),s=t.querySelector(".page__content"),n=()=>{tabletWidthMediaQueryList.matches?s.append(e):t.append(e)};n(),tabletWidthMediaQueryList.addEventListener("change",(()=>{n()}))}function initTariffs(){const e=document.querySelector(".tariffs"),t=e.querySelector(".tariffs__slider"),s=e.querySelectorAll(".tariff-card"),n=document.querySelectorAll(".pricing__toggle-button"),i=e.querySelector(".tariffs__button--left"),r=e.querySelector(".tariffs__button--right"),a=e.querySelector(".tariff-card--enterprise"),l=a.querySelectorAll(".tariff-card__prices [data-month-price]"),o=a.querySelector(".tariff-card__prices [data-year-price]"),c=a.querySelector(".dropdown__list");c?.addEventListener("click",(e=>{const t=e.target.closest(".dropdown__item-button");if(!t)return;const{monthPrice:s,yearPrice:n}=t.dataset;((e,t)=>{l.forEach((t=>{e&&(t.textContent=`${Number(e).toLocaleString()} ₽/мес.`)})),o&&t&&(o.textContent=`${Number(t).toLocaleString()} ₽/мес.`)})(s,n)}));const d=e=>{e.isBeginning?(i.classList.add("tariffs__button--hidden"),r.classList.remove("tariffs__button--hidden")):e.isEnd&&(i.classList.remove("tariffs__button--hidden"),r.classList.add("tariffs__button--hidden"))},u=new Swiper(t,{slidesPerView:"auto",spaceBetween:16,breakpoints:{1440:{slidesPerView:4,spaceBetween:16},1920:{slidesPerView:5,spaceBetween:16}}});u.on("toEdge",(()=>{d(u)})),d(u),i.addEventListener("click",(()=>{u.slideTo(0)})),r.addEventListener("click",(()=>{u.slideTo(4)}));n.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),n.forEach((e=>e.classList.remove("pricing__toggle-button--active"))),e.currentTarget.classList.add("pricing__toggle-button--active");(e=>{s.forEach((t=>{"month"===e?(t.classList.remove("tariff-card--payment-type_year"),t.classList.add("tariff-card--payment-type_month")):(t.classList.add("tariff-card--payment-type_year"),t.classList.remove("tariff-card--payment-type_month"))}))})(e.currentTarget.dataset.type)}))}))}const tabletWidthMediaQueryList=window.matchMedia("(min-width: 768px)"),inputEvent=new Event("input",{bubbles:!0});initPageSlider(),initSkeletons(),initBanners(document.querySelector(".banners")),initSocials(document.querySelector(".socials")),initTariffs(),initLicenses(),document.querySelectorAll(".dropdown").forEach(initDropdown),initAnchors(),document.querySelectorAll('input[type="tel"]').forEach(initPhoneField);const successAlert={heading:"Спасибо за вашу заявку!",text:"Ваша заявка успешно отправлена.<br> Мы свяжемся с вами в ближайшее время."},errorAlert={heading:"Что-то пошло не так",text:"Не удалось отправить заявку.<br> Попробуйте снова или свяжитесь с нами по телефону.",status:"error"},feedbackModal=new ModalForm(document.querySelector('[data-modal="feedback-form"]'));feedbackModal.setHandlers((()=>{showAlert(successAlert)}),(()=>{const e=showAlert(errorAlert);initFormResending(feedbackModal.form,e)}));const priceModal=new ModalForm(document.querySelector('[data-modal="price-form"]'));priceModal.setHandlers((()=>{showAlert(successAlert)}),(()=>{const e=showAlert(errorAlert);initFormResending(feedbackModal.form,e)}));